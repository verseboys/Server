<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=no,minimal-ui">
  <title>医咖会</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
  <script src="https://unpkg.com/axios@0.18.0/dist/axios.min.js"></script>
</head>
<body>
{% verbatim %}
<div id="root">
  <div style="margin-top: 200px;">
    <div style="text-align: center;display: table;margin:auto auto">
      <div v-show="status">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36">
          <g fill="none" fill-rule="evenodd">
            <path fill="#46B229" d="M0 18c0 9.956 8.044 18 18 18s18-8.044 18-18S27.956 0 18 0 0 8.044 0 18z"/>
            <path fill="#FFF"
                  d="M28.528 11.233c-.517-.355-1.321-.304-1.723.151l-9.883 10.782-5.86-5.265a1.295 1.295 0 0 0-1.667 0c-.517.405-.517 1.063-.057 1.519l6.263 5.669s.574.557.69.658c.229.152.459.253.746.253h.115c.287 0 .575-.101.747-.304.115-.1.69-.81.69-.81l10.17-11.084c.401-.557.286-1.215-.23-1.57z"/>
          </g>
        </svg>
      </div>
      <div v-show="!status">
        <svg width="36px" height="36px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"
             xmlns:xlink="http://www.w3.org/1999/xlink">
          <!-- Generator: Sketch 52.2 (67145) - http://www.bohemiancoding.com/sketch -->
          <title>失败</title>
          <desc>Created with Sketch.</desc>
          <g id="慢阻肺专项" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="慢阻肺项目-提示信息" transform="translate(-416.000000, -1024.000000)">
              <g id="分组-2" transform="translate(416.000000, 1023.000000)">
                <g id="失败" transform="translate(0.000000, 1.000000)">
                  <path
                    d="M0,10 C2.17941607e-15,15.5228475 4.4771525,20 10,20 C15.5228475,20 20,15.5228475 20,10 C20,4.4771525 15.5228475,0 10,0 C4.4771525,-7.26472022e-16 2.17941607e-15,4.4771525 0,10 Z"
                    id="路径" fill="#FF5700"></path>
                  <path
                    d="M9.22081243,14.9130125 C9.22081243,15.1964479 9.30453099,15.4797951 9.44977766,15.6816314 C9.59502434,15.8834678 9.79608338,16 10.0028581,16 C10.206775,16 10.4106919,15.883556 10.5559386,15.6816314 C10.7011853,15.4797951 10.7849038,15.2003294 10.7849038,14.9130125 C10.7849038,14.6296654 10.7011853,14.34623 10.5559386,14.1443937 C10.4106919,13.9425573 10.2096329,13.8261133 10.0028581,13.8261133 C9.79894122,13.8261133 9.59502431,13.9425573 9.44977766,14.1443937 C9.30453099,14.3501115 9.22081243,14.6296654 9.22081243,14.9130125 Z M11,5.04940843 C11,4.46895254 10.5530807,4.00000063 10.0000003,4.00000063 C9.7347095,3.99969592 9.48019967,4.11015753 9.29260278,4.30702322 C9.1050059,4.50388891 8.99973247,4.77098674 9.00000051,5.04940843 C9.00000051,5.06996256 9.00000051,5.09042849 9.00285838,5.11098264 L9.22072838,11.7976052 C9.22072838,12.2490023 9.56989193,12.6153599 9.9999162,12.6153599 C10.4301086,12.6153599 10.7792721,12.2490023 10.7792722,11.7976052 L10.9971421,5.11098264 C10.9971421,5.09042852 11,5.06996258 11,5.04940843 Z"
                    id="形状" fill="#FFFFFF" fill-rule="nonzero"></path>
                </g>
              </g>
            </g>
          </g>
        </svg>
      </div>
      <div
        style="display: table-cell;text-align: center;vertical-align: middle; padding-left: 20px; font-size: 20px;line-height: 28px;color: #4a4a4a;font-family: PingFangSC-Medium">
        <div v-show="!status">{{message}}</div>
        <a href="https://www.mediecogroup.com/login/?next=/#1" v-show="status" style="text-decoration: none"></a>
      </div>
    </div>
    <h3
      style="width: 205px;height: 36px;margin:0 auto;font-size: 20px;color:#4a4a4a;font-weight: 500;letter-spacing: 0.6px;text-align:center;padding-top: 20px;"
      v-show="status">
      邮箱验证成功！</h3>
    <p
      style="width: 330px;height: 36px;margin:0 auto;font-size: 16px;letter-spacing: 0.4px;color: #4a4a4a;text-align:center;"
      v-show="status">
      请使用账号和密码登录医咖会，观看培训视频</p>
    <div style="width: 205px;height: 36px;margin: 5px auto;border-radius: 4px;background-color: #449fea;"
         v-show="status">
      <a
        style="width: 205px;line-height:36px;color: white;font-size: 18px;text-decoration:none;text-align: center;display: inline-block"
        href="https://www.mediecogroup.com/login/?next=/networks/1/#1">去登录</a>
    </div>
  </div>
</div>
{% endverbatim %}
<script>
new Vue({
  el: '#root',
  data: {
    message: '验证中...',
    status: false,
  },
  methods: {
    verifyUser() {
      let vm = this
      axios.post('/users', {action: 'activate-network-user', code: vm.code}).then(function (response) {
        vm.message = '邮箱验证成功，请登录'
        vm.status = true
      }).catch(function (e) {
        if (e.response) {
          vm.message = e.response.data.message || '服务器开小差了'
        } else if (e.request) {
          vm.message = '服务器开小差了'
        } else {
          vm.message = '网络不太稳定'
        }
      })
    },
    getQueryVariable(variable) {
      let query = window.location.search.substring(1);
      let vars = query.split("&");
      for (let i = 0; i < vars.length; i++) {
        let pair = vars[i].split("=");
        if (pair[0] == variable) {
          return pair[1];
        }
      }
      return false;
    },
    initialize() {
      this.verifyUser()
    },
  },
  created() {
    let vm = this
    vm.code = vm.getQueryVariable('code')
    vm.initialize()
  },
})
</script>
</body>